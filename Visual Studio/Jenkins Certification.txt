****  In this lesson, we will install Jenkins and become familiar with the Installation wizard.
      Here are the commands for installing the Jenkins package:

wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
rpm --import http://pkg.jenkins.io/redhat-stable/jenkins.io.key
yum install -y jenkins-2.19.4-1.1


**Be sure to disable the source as described at the end of the video as well, so you don't accidentally get an update. 
      The certification test is built around this version specifically. That's done with the following:
      This is for disabling the jenkins upgrade accidentally reboot 

yum-config-manager --disable jenkins

****  For listing out other jenkins versions
     
      yum list --show-duplicates jenkins

      netstat -tulpn | grep 8080   -  for checking if 8080 is available
      systemctl start jenkins
      netstat -tulpn | grep 8080   -  now to check if jenkins is installed with 8080



alternatives --install /usr/bin/java java /usr/java/latest/bin/java 200000

alternatives --install /usr/bin/javac javac /usr/java/latest/bin/javac 200000

alternatives --install /usr/bin/jar jar /usr/java/latest/bin/jar 200000


Set JAVA_HOME environmental variable in rc.local.

vi /etc/rc.local
export JAVA_HOME="/usr/java/latest"

All installed in CentOS

54.187.14.160	primary	172.31.30.169	pranjal363.mylabserver.com  (Jenkins Master Installed Node)   4321

54.201.161.201	new slave	172.31.109.25	pranjal365.mylabserver.com  (jenkins Slave Installed Node)    4232


54.203.241.200	Workstation	172.31.96.229	pranjal366.mylabserver.com  (Workstation Installed Node)

Now we need to generate a ssh key

su jenkins -s /bin/bash
ssh-keygen



cat /var/lib/jenkins/.ssh/id_rsa.pub

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDAxI/r6kgE4FmVrzi704MzRdDgCH6X57NEgxEXL/FvbZCmfO+Ogg95D4jO5Eyowgk2ABt9+oGd0cojCBe0
Mkhu63c+J5pUkHS/UzTqaSe98Oz9gICKAymZrwfTcr/xOlkbOJjd5oI83NkHXIhl6qScMEuwZLjgPFBUXQXmXBthGJSx5uJu7104bfaQsUzT1z40ebVqQwBK
Gk8G0qBgF7LpLGnytrIb9QRXnrM6J+iSG0DuXxqplpLcl2KgrHnpFq60nT0PK4yqJBJgE9XcSztGIXWZ6Ieo9Q3niTFWBtIa+tX+Xf1uB5BNbtED+arYIcVU
vVcRQZGIe3XrC+Kt01qZ jenkins@pranjal363.mylabserver.com


for adding jenkins user into our slave

useradd -a /var/lib/jenkins jenkins
mkdir /var/lib/jenkins/.ssh
vi /var/lib/jenkins/.ssh/authorized_keys
paste the key into this file

and then install java which is there in the Previous notes



Cron 

Every 15 mins   H/15 * * * *
Every mins      * * * * *


Workspace Environment Variables

echo "Generic Jenkins Variables"
echo "Build Number $BUILD_NUMBER"
echo "Node Name $NODE_NAME"
echo "Job Name $JOB_NAME"
echo "Executor Number $ECECUTOR_NUMBER"
echo "Workspace $WORKSPACE"


echo "GIT Environmental Variables"
echo "GIT Commit $GIT_COMMIT"
echo "GIT Branch $GIT_BRANCH"
echo "GIT Previous Commit $GIT_PREVIOUS_COMMIT"
echo "GIT URL $GIT_URL"



Adding docker into SLave Node

yum remove docker docker-common container-selinux

yum install -y yum-utils

yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

yum clean all  - to clear cache 

yum install docker-ce-17.03.0.ce-1.el7.centos

gpasswd -a jenkins docker       -  to add the jenkins user to the docker group

systemctl start docker    -  start the docker service


Master Node
systemctl restart jenkins

systemctl status jenkins

Jenkins Issue:

Setting the git paramaterized plugin:
https://stackoverflow.com/questions/29034240/gerrit-trigger-for-jenkins-couldnt-find-any-revision-to-build/41551181#41551181

setting up docker:
https://stackoverflow.com/questions/43401645/cannot-connect-to-the-docker-daemon-at-unix-var-run-docker-sock-is-the-docke


Installing ANT on both master and slave

wget http://www.us.apache.org/dist/ant/binaries/apache-ant-1.10.1-bin.tar.gz

tar xvzf apache-ant-1.10.1-bin.tar.gz

tar xvfvz apache-ant-1.10.1-bin.tar.gz -C /opt

ln -s /opt/apache-ant-1.10.1/ /opt/ant

sh -c 'echo ANT_HOME=/opt/ant >> /etc/environment'

ln -s /opt/ant/bin/ant /usr/bin/ant

to verify

ls -al /usr/bin | grep ant

ant -version


(
      Testing is in progress.
      testing in in prfe
      
)